<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartPoi Controls</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="ic_launcher-web.png">
    <script src="jimp.min.js"></script>
</head>

<body>
    <div class="app-container">
        <div class="header">
            <img src="smaller-logo.jpg" alt="POI Logo" class="logo">
            <div class="tabs">
                <button class="tab-button active" data-tab="controls">Controls</button>
                <button class="tab-button" data-tab="images">Image Management</button>
            </div>
        </div>

        <!-- Controls Tab -->
        <div id="controls" class="tab-content active">
            <div class="control-block">
                <h2 class="section-title">Poi Controls</h2>

                <div class="status-indicators">
                    <div id="mainStatus" class="status-indicator online">Main POI: Online</div>
                    <div id="auxStatus" class="status-indicator online">Aux POI: Online</div>
                </div>

                <div class="control-block">
                    <h3 class="section-title">Pattern Selection</h3>
                    <div class="pattern-buttons">
                        <button data-pattern="1" onclick="submitPattern('1')">Generated</button>
                        <button data-pattern="2" onclick="submitPattern('2')">IMG 1-5</button>
                        <button data-pattern="3" onclick="submitPattern('3')">IMG 6-10</button>
                        <button data-pattern="4" onclick="submitPattern('4')">IMG 10-20</button>
                        <button data-pattern="5" onclick="submitPattern('5')">IMG 1-52</button>
                        <button data-pattern="6" onclick="submitPattern('6')">On/Off Switch</button>
                        <button data-pattern="7" onclick="submitPattern('7')">LEDs OFF</button>
                    </div>
                </div>

                <div class="control-block">
                    <h3 class="section-title">Synchronization</h3>
                    <button id="syncButton">Sync Poi</button>
                </div>

                <div class="control-block">
                    <h3 class="section-title">Adjustments</h3>
                    <div class="slider-group">
                        <div class="slider-container speed-slider">
                            <label>Speed (0.5-1800s)</label>
                            <input type="range" id="speedSlider" min="0" max="100" value="0">
                            <div id="speedTooltip" class="tooltip"></div>
                        </div>

                        <div class="slider-container brightness-slider">
                            <label>Brightness (20-255)</label>
                            <input type="range" id="brightnessSlider" min="20" max="255" value="20">
                            <div id="brightnessTooltip" class="tooltip"></div>
                        </div>
                    </div>
                </div>

                <!-- Network Discovery -->
                <div class="control-block">
                    <h3 class="section-title">Network Discovery</h3>
                    <div class="discovery-section">
                        <label>WiFi Poi IP Address Discovery (Router Mode)</label>
                        <div class="discovery-input-group">
                            <input type="text" id="routerIpInput" placeholder="192.168.1.1" value="">
                            <button type="button" id="discoverBtn">Discover POI</button>
                            <span id="ipError" class="error-message"></span>
                        </div>
                        <div class="manual-ip-section">
                            <div class="manual-ip-group">
                                <div class="manual-ip-row">
                                    <input type="text" id="manualMainIp" placeholder="192.168.1.x" value="">
                                    <button onclick="setMainIp()">Set Main</button>
                                    <span id="mainIpError" class="error-message"></span>
                                </div>
                                <div class="manual-ip-row">
                                    <input type="text" id="manualAuxIp" placeholder="192.168.1.x" value="">
                                    <button onclick="setAuxIp()">Set Aux</button>
                                    <span id="auxIpError" class="error-message"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Add Spinner and Counter -->
                        <div class="spinner" id="spinner"></div>
                        <p id="counter">Scanning IP: <span id="currentIP">0</span> for poi!</p>

                        <!-- Add Status Section -->
                        <div class="status-section">
                            <h3 class="section-title">Poi Status</h3>
                            <button id="fetchBtn">Fetch Settings</button>
                            <div class="poi-status-group">
                                <h4>Main Poi:</h4>
                                <p>Router: <span id="router">N/A</span></p>
                                <p>Password: <span id="password">N/A</span></p>
                                <p>Channel: <span id="channel">N/A</span></p>
                                <p>Pattern: <span id="pattern">N/A</span></p>
                                <p>Pixels: <span id="pixels">?</span></p>
                            </div>

                            <div class="poi-status-group">
                                <h4>Auxiliary Poi:</h4>
                                <p>Router: <span id="routerTwo">N/A</span></p>
                                <p>Password: <span id="passwordTwo">N/A</span></p>
                                <p>Channel: <span id="channelTwo">N/A</span></p>
                                <p>Pattern: <span id="patternTwo">N/A</span></p>
                                <p>Pixels: <span id="pixelsTwo">?</span></p>
                            </div>
                        </div>
                    </div>
                </div>



                <div class="danger-zone">
                    <h3 class="danger-title">DANGER ZONE</h3>
                    <div>
                        <label>
                            Update Router Name and Password:
                            <input type="text" id="routerInput" placeholder="Enter Router Name">
                            <input type="text" id="passwordInput" placeholder="Enter Router Password">
                            <button type="button" onclick="submitRouter()">Submit</button>
                        </label>
                    </div>
                    <div>
                        <label>
                            Switch for Router Mode (submit unchecked to turn off):
                            <input type="checkbox" id="routerModeCheckbox" value="0">
                            <button type="button" onclick="submitRouterMode()">Submit</button>
                        </label>
                    </div>
                    <div>
                        <label>
                            Update WiFi Channel (1-13):
                            <input type="number" id="channelInput" min="1" max="13" placeholder="1-13">
                            <button type="button" onclick="submitChannel()">Update Channel</button>
                        </label>
                    </div>
                </div>
            </div>

        </div> <!-- Close controls tab content -->

        <!-- Images Tab -->
        <div id="images" class="tab-content">
            <div class="image-management">
                <h2 class="section-title">Image Management</h2>
                <div class="image-controls">
                    <button id="refreshImages">Refresh Images</button>
                    <button class="dark-button" onclick="getFilesAndDisplay()">Fetch and Display All Images</button>
                    <button class="dark-button" onclick="window.location.reload()">Refresh Page</button>
                    <div class="pixel-control">
                        <input type="number" id="pixelInput" min="1" max="1000">
                        <button id="updatePixels">Update Pixels</button>
                        <span class="current-px" id="currentPx"></span>
                    </div>
                    <div class="fetch-buttons">
                        <button class="dark-button" onclick="getFilesOne()">Fetch Main Poi Images</button>
                        <span class="alert-indicator" id="get-files-one-indicator"></span>
                        <button class="dark-button" onclick="getFilesTwo()">Fetch Aux Poi Images</button>
                        <span class="alert-indicator" id="get-files-two-indicator"></span>
                        <button class="dark-button" id="ws_apaBtn">WS2812?</button>
                        <span class="alert-indicator" id="ws_apa_indicator">Current: WS2812</span>
                    </div>
                    <p><i>Default is WS2812, click to change to APA102 (raw mode)</i></p>
                </div>


                <div class="image-grid">
                    <div class="poi-images">
                        <h3 class="section-title">Main Poi</h3>
                        <div id="mainImageGrid" class="image-grid-container"></div>
                    </div>
                    <div class="poi-images">
                        <h3 class="section-title">Aux Poi</h3>
                        <div id="auxImageGrid" class="image-grid-container"></div>
                    </div>
                </div>

            </div>
            <button id="deleteAllButton" class="dark-button" style="background-color: #4a1e1e;">
                ! DELETE ALL IMAGES ON BOTH POIs !
            </button>
            <p><i>This will permanently remove all images from both POIs!</i></p>
        </div>

        <!-- Modal -->
        <div class="modal-overlay hidden">
            <div class="modal-content">
                <img class="modal-image" alt="Enlarged View">
                <div class="modal-footer">
                    <span class="filename"></span>
                    <div class="modal-controls">
                        <button class="delete-button">Delete</button>
                        <input type="number" id="brightnessAdjust" min="-1" max="1" step="0.1" value="0">
                        <button onclick="applyBrightness()">Adjust Brightness</button>
                        <button class="close-button">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="main.js"></script>
</body>

</html>
